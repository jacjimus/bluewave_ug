"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.db = void 0;
const { Sequelize, DataTypes, Op, QueryTypes } = require('sequelize');
require('dotenv').config();
const sequelize = new Sequelize(process.env.DB_URL, { dialect: "postgres" });
sequelize.authenticate().then(() => {
    console.log(`Database connected to Bluewave! time: ${new Date()}`);
}).catch((err) => {
    console.log(err);
});
exports.db = {};
exports.db.Sequelize = Sequelize;
exports.db.sequelize = sequelize;
//connecting to model
exports.db.users = require('./User')(sequelize, DataTypes);
exports.db.policies = require('./Policy')(sequelize, DataTypes);
exports.db.claims = require('./Claim')(sequelize, DataTypes);
exports.db.payments = require('./Payment')(sequelize, DataTypes);
exports.db.sessions = require('./Session')(sequelize, DataTypes);
exports.db.beneficiaries = require('./Beneficiary')(sequelize, DataTypes);
exports.db.partners = require('./Partner')(sequelize, DataTypes);
exports.db.products = require('./Product')(sequelize, DataTypes);
exports.db.logs = require('./Log')(sequelize, DataTypes);
exports.db.transactions = require('./Transaction')(sequelize, DataTypes);
exports.db.installments = require('./Installment')(sequelize, DataTypes);
exports.db.user_hospitals = require('./UserHospital')(sequelize, DataTypes);
exports.db.hospitals = require('./Hospital')(sequelize, DataTypes);
exports.db.hospitals_kenya = require('./HospitalKenya')(sequelize, DataTypes);
exports.db.policy_schedules = require('./PolicySchedule')(sequelize, DataTypes);
exports.db.vehicles = require('./Vehicle')(sequelize, DataTypes);
exports.db.users.hasMany(exports.db.policies, { foreignKey: 'user_id' });
exports.db.policies.belongsTo(exports.db.users, { foreignKey: 'user_id' });
exports.db.payments.belongsTo(exports.db.users, { foreignKey: 'user_id' });
exports.db.payments.belongsTo(exports.db.policies, { foreignKey: 'policy_id' });
exports.db.policies.hasMany(exports.db.payments, { foreignKey: 'policy_id' });
exports.db.policies.hasMany(exports.db.claims, { foreignKey: 'policy_id' });
exports.db.claims.belongsTo(exports.db.policies, { foreignKey: 'policy_id' });
exports.db.users.hasMany(exports.db.claims, { foreignKey: 'user_id' });
exports.db.claims.belongsTo(exports.db.users, { foreignKey: 'user_id' });
exports.db.users.hasMany(exports.db.sessions, { foreignKey: 'user_id' });
exports.db.sessions.belongsTo(exports.db.users, { foreignKey: 'user_id' });
exports.db.users.hasMany(exports.db.beneficiaries, { foreignKey: 'user_id' });
exports.db.beneficiaries.belongsTo(exports.db.users, { foreignKey: 'user_id' });
exports.db.users.hasMany(exports.db.transactions, { foreignKey: 'user_id' });
exports.db.transactions.belongsTo(exports.db.users, { foreignKey: 'user_id' });
exports.db.policies.hasMany(exports.db.transactions, { foreignKey: 'policy_id' });
exports.db.transactions.belongsTo(exports.db.policies, { foreignKey: 'policy_id' });
module.exports = { db: exports.db };
